<html>
<head>
<title>Morphisms.v</title>
<style>
.time {
  background-color: #ffaaaa;
  height: 100%;
  z-index: -1;
  position: absolute;
}
.code {
  z-index: 0;
  position: relative;
  border-style: solid;
  border-color: transparent;
  border-width: 1px;
}
.code:hover {
  border-style: solid;
  border-color: black;
  border-width: 1px;
}
pre {
  margin: 1px;
}
</style>
</head>
<body>
<h1>Timings for Morphisms.v</h1>

<div class="code" title="File: Morphisms.v
Line: 1
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>(** * Definitions and theorems about {iso,epi,mono,}morphisms in a precategory *)</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 1
Time: 0.007s">
<div class="time" style="width: 10.606060606061%"></div>
<pre>Require Import Category.Core Functor.Core.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 1
Time: 0.034s">
<div class="time" style="width: 51.515151515152%"></div>
<pre>
Require Import HoTT.Tactics Trunc HProp Types.Sigma Equivalences.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 2
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Set Universe Polymorphism.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 4
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Set Implicit Arguments.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 5
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Generalizable All Variables.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 6
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Set Asymmetric Patterns.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 7
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Local Open Scope category_scope.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 9
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Local Open Scope morphism_scope.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 10
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Definition of isomorphism *)</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 12
Time: 0.005s">
<div class="time" style="width: 7.5757575757576%"></div>
<pre>Class IsIsomorphism {C : PreCategory} {s d} (m : morphism C s d) :=
  {
    morphism_inverse : morphism C d s;
    left_inverse : morphism_inverse o m = identity _;
    right_inverse : m o morphism_inverse = identity _
  }.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 17
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Arguments morphism_inverse {C s d} m {_}.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 19
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Local Notation "m ^-1" := (morphism_inverse m) : morphism_scope.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 21
Time: 0.001s">
<div class="time" style="width: 1.5151515151515%"></div>
<pre>

Hint Resolve left_inverse right_inverse : category morphism.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 23
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Hint Rewrite @left_inverse @right_inverse : category.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 24
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Hint Rewrite @left_inverse @right_inverse : morphism.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 25
Time: 0.002s">
<div class="time" style="width: 3.030303030303%"></div>
<pre>

Class Isomorphic {C : PreCategory} s d :=
  {
    morphism_isomorphic : morphism C s d;
    isisomorphism_isomorphic :&gt; IsIsomorphism morphism_isomorphic
  }.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 31
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(*Coercion Build_Isomorphic : IsIsomorphism &gt;-&gt; Isomorphic.*)</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 33
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Coercion morphism_isomorphic : Isomorphic &gt;-&gt; morphism.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 33
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Coercion isisomorphism_isomorphic : Isomorphic &gt;-&gt; IsIsomorphism.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 34
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Local Infix "&lt;~=~&gt;" := Isomorphic : category_scope.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 36
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Global Existing Instance isisomorphism_isomorphic.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 38
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Theorems about isomorphisms *)</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 40
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section iso_contr.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 40
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Variable C : PreCategory.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 41
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>



  Variables s d : C.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 45
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Local Notation IsIsomorphism_sig_T m :=
    { inverse : morphism C d s
    | { _ : inverse o m = identity _
      | m o inverse = identity _ } } (only parsing).</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 50
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Section IsIsomorphism.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 52
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Variable m : morphism C s d.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 53
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** *** The inverse of a morphism is unique *)
   </pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 56
Time: 0.001s">
<div class="time" style="width: 1.5151515151515%"></div>
<pre>Lemma inverse_unique (m_inv0 m_inv1 : morphism C d s)
          (left_inverse_0 : m_inv0 o m = identity _)
          (right_inverse_1 : m o m_inv1 = identity _)
    : m_inv0 = m_inv1.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 59
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 60
Time: 0.028s">
<div class="time" style="width: 42.424242424242%"></div>
<pre>
      transitivity (m_inv0 o m o m_inv1);
      try solve [ by (rewrite -&gt; ?associativity; rewrite_hyp;
                      autorewrite with morphism)
                | by (rewrite &lt;- ?associativity; rewrite_hyp;
                      autorewrite with morphism) ].</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 65
Time: 0.001s">
<div class="time" style="width: 1.5151515151515%"></div>
<pre>
    Qed.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 66
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** *** Equivalence between the record and sigma versions of [IsIsomorphism] *)
   </pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 69
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Lemma issig_isisomorphism
    : IsIsomorphism_sig_T m &lt;~&gt; IsIsomorphism m.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 70
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 71
Time: 0.033s">
<div class="time" style="width: 50%"></div>
<pre>
      issig.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 72
Time: 0.004s">
<div class="time" style="width: 6.0606060606061%"></div>
<pre>
    Defined.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 73
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** *** Being an isomorphism is a mere proposition *)
   </pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 76
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance trunc_isisomorphism : IsHProp (IsIsomorphism m).</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 76
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 77
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      eapply trunc_equiv'; [ exact issig_isisomorphism | ].</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 78
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply hprop_allpath.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 79
Time: 0.006s">
<div class="time" style="width: 9.0909090909091%"></div>
<pre>
      intros [x [? ?]] [y [? ?]].</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 80
Time: 0.003s">
<div class="time" style="width: 4.5454545454545%"></div>
<pre>
      let H := fresh in
      assert (H : x = y) by (apply inverse_unique; assumption);
        destruct H.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 83
Time: 0.066s">
<div class="time" style="width: 100%"></div>
<pre>
      repeat match goal with
               | _ =&gt; progress simpl
               | _ =&gt; exact (center _)
               | _ =&gt; (exists idpath)
               | _ =&gt; apply path_sigma_uncurried
             end.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 89
Time: 0.01s">
<div class="time" style="width: 15.151515151515%"></div>
<pre>
    Qed.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 90
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  End IsIsomorphism.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 91
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Local Notation Isomorphic_sig_T :=
    { m : morphism C s d
    | IsIsomorphism m } (only parsing).</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 95
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** *** Equivalence between record and sigma versions of [Isomorphic] *)
 </pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 98
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Lemma issig_isomorphic
  : Isomorphic_sig_T &lt;~&gt; Isomorphic s d.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 99
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 100
Time: 0.009s">
<div class="time" style="width: 13.636363636364%"></div>
<pre>
    issig.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 101
Time: 0.001s">
<div class="time" style="width: 1.5151515151515%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 102
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Local Notation Isomorphic_full_sig_T :=
    { m : morphism C s d
    | IsIsomorphism_sig_T m } (only parsing).</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 106
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** *** Equivalence between record and fully sigma versions of [Isomorphic] *)
 </pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 109
Time: 0.002s">
<div class="time" style="width: 3.030303030303%"></div>
<pre>Definition issig_full_isomorphic
  : Isomorphic_full_sig_T &lt;~&gt; Isomorphic s d
    := (issig_isomorphic oE equiv_functor_sigma_id issig_isisomorphism).</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 111
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** *** Isomorphisms form an hSet *)
 </pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 114
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance trunc_Isomorphic : IsHSet (Isomorphic s d).</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 114
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 115
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    eapply trunc_equiv'; [ exact issig_isomorphic | ].</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 116
Time: 0.004s">
<div class="time" style="width: 6.0606060606061%"></div>
<pre>
    typeclasses eauto.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 117
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Qed.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 118
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** *** Equality between isomorphisms is determined by equality between their forward components *)
 </pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 121
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition path_isomorphic (i j : Isomorphic s d)
  : @morphism_isomorphic _ _ _ i = @morphism_isomorphic _ _ _ j
    -&gt; i = j.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 123
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 124
Time: 0.001s">
<div class="time" style="width: 1.5151515151515%"></div>
<pre>
    destruct i, j; simpl.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 125
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intro; path_induction.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 126
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    f_ap.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 127
Time: 0.001s">
<div class="time" style="width: 1.5151515151515%"></div>
<pre>
    exact (center _).</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 128
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 129
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** *** Relations between [path_isomorphic], [ap morphism_inverse], and [ap morphism_isomorphic] *)
 </pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 132
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Definition ap_morphism_isomorphic_path_isomorphic (i j : Isomorphic s d) p
  : ap (@morphism_isomorphic _ _ _) (path_isomorphic i j p) = p.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 133
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 134
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    unfold path_isomorphic.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 135
Time: 0.002s">
<div class="time" style="width: 3.030303030303%"></div>
<pre>
    destruct i, j.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 136
Time: 0.027s">
<div class="time" style="width: 40.909090909091%"></div>
<pre>
    path_induction_hammer.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 137
Time: 0.002s">
<div class="time" style="width: 3.030303030303%"></div>
<pre>
  Qed.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 138
Time: 0.001s">
<div class="time" style="width: 1.5151515151515%"></div>
<pre>

  Definition ap_morphism_inverse_path_isomorphic (i j : Isomorphic s d) p q
  : ap (fun e : Isomorphic s d =&gt; e^-1)%morphism (path_isomorphic i j p) = q.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 141
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 142
Time: 0.001s">
<div class="time" style="width: 1.5151515151515%"></div>
<pre>
    apply path_ishprop.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 143
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Qed.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 144
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** *** Equality between isomorphisms is equivalent to by equality between their forward components *)
 </pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 147
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance isequiv_path_isomorphic
  : IsEquiv (path_isomorphic i j).</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 148
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 149
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    intros.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 150
Time: 0.028s">
<div class="time" style="width: 42.424242424242%"></div>
<pre>
    apply (isequiv_adjointify
             (path_isomorphic i j)
             (ap (@morphism_isomorphic _ _ _)));
      intro; [ destruct i | destruct i, j ];
      path_induction_hammer.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 155
Time: 0.002s">
<div class="time" style="width: 3.030303030303%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 156
Time: 0.004s">
<div class="time" style="width: 6.0606060606061%"></div>
<pre>
End iso_contr.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 157
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Section iso_equiv_relation.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 159
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Variable C : PreCategory.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 160
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** *** The identity is an isomorphism *)
 </pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 163
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance isisomorphism_identity (x : C) : IsIsomorphism (identity x)
    := {| morphism_inverse := identity x;
          left_inverse := left_identity C x x (identity x);
          right_inverse := right_identity C x x (identity x) |}.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 166
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** *** Inverses of isomorphisms are isomorphisms *)
 </pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 169
Time: 0.001s">
<div class="time" style="width: 1.5151515151515%"></div>
<pre>Definition isisomorphism_inverse `(@IsIsomorphism C x y m) : IsIsomorphism m^-1
    := {| morphism_inverse := m;
          left_inverse := right_inverse;
          right_inverse := left_inverse |}.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 172
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Local Ltac iso_comp_t inv_lemma :=
    etransitivity; [ | apply inv_lemma ];
    instantiate;
    first [ rewrite -&gt; ?associativity; apply ap
          | rewrite &lt;- ?associativity; apply ap ];
    first [ rewrite -&gt; ?associativity; rewrite inv_lemma
          | rewrite &lt;- ?associativity; rewrite inv_lemma ];
    auto with morphism.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 181
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** *** Composition of isomorphisms gives an isomorphism *)
 </pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 184
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance isisomorphism_compose `(@IsIsomorphism C y z m0) `(@IsIsomorphism C x y m1)
  : IsIsomorphism (m0 o m1).</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 185
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 186
Time: 0.014s">
<div class="time" style="width: 21.212121212121%"></div>
<pre>
    exists (m1^-1 o m0^-1);
    [ abstract iso_comp_t @left_inverse
    | abstract iso_comp_t @right_inverse ].</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 189
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 190
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Hint Immediate isisomorphism_inverse : typeclass_instances.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 192
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** *** Being isomorphic is a reflexive relation *)
 </pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 195
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance isomorphic_refl : Reflexive (@Isomorphic C)
    := fun x : C =&gt; {| morphism_isomorphic := identity x |}.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 196
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** *** Being isomorphic is a symmetric relation *)
 </pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 199
Time: 0.001s">
<div class="time" style="width: 1.5151515151515%"></div>
<pre>Global Instance isomorphic_sym : Symmetric (@Isomorphic C)
    := fun x y X =&gt; {| morphism_isomorphic := X^-1 |}.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 200
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** *** Being isomorphic is a transitive relation *)
 </pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 203
Time: 0.001s">
<div class="time" style="width: 1.5151515151515%"></div>
<pre>Global Instance isomorphic_trans : Transitive (@Isomorphic C)
    := fun x y z X Y =&gt; {| morphism_isomorphic := @morphism_isomorphic _ _ _ Y o @morphism_isomorphic _ _ _ X |}.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 204
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** *** Equality gives rise to isomorphism *)
 </pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 207
Time: 0.001s">
<div class="time" style="width: 1.5151515151515%"></div>
<pre>Definition idtoiso (x y : C) (H : x = y) : Isomorphic x y
    := match H in (_ = y0) return (x &lt;~=~&gt; y0) with
         | 1%path =&gt; reflexivity x
       end.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 210
Time: 0.001s">
<div class="time" style="width: 1.5151515151515%"></div>
<pre>
End iso_equiv_relation.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 211
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Hint Immediate isisomorphism_inverse : typeclass_instances.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 213
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Epimorphisms and Monomorphisms *)
(** Quoting Wikipedia:

    In category theory, an epimorphism (also called an epic morphism
    or, colloquially, an epi) is a morphism [f : X → Y] which is
    right-cancellative in the sense that, for all morphisms [g, g' : Y
    → Z], [g ∘ f = g' ∘ f → g = g']

    Epimorphisms are analogues of surjective functions, but they are
    not exactly the same. The dual of an epimorphism is a monomorphism
    (i.e. an epimorphism in a category [C] is a monomorphism in the
    dual category [Cᵒᵖ]).  *)

</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 227
Time: 0.001s">
<div class="time" style="width: 1.5151515151515%"></div>
<pre>Class IsEpimorphism {C} {x y} (m : morphism C x y) :=
  is_epimorphism : forall z (m1 m2 : morphism C y z),
                     m1 o m = m2 o m
                     -&gt; m1 = m2.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 230
Time: 0.001s">
<div class="time" style="width: 1.5151515151515%"></div>
<pre>
Class IsMonomorphism {C} {x y} (m : morphism C x y) :=
  is_monomorphism : forall z (m1 m2 : morphism C z x),
                      m o m1 = m o m2
                      -&gt; m1 = m2.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 234
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** We make [IsEpimorphism] and [IsMonomorphism] transparent to
    typeclass search so that we can infer things like [IsHProp]
    automatically. *)</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 238
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Typeclasses Transparent IsEpimorphism IsMonomorphism.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 238
Time: 0.002s">
<div class="time" style="width: 3.030303030303%"></div>
<pre>

Record Epimorphism {C} x y :=
  {
    Epimorphism_morphism :&gt; morphism C x y;
    Epimorphism_IsEpimorphism :&gt; IsEpimorphism Epimorphism_morphism
  }.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 244
Time: 0.001s">
<div class="time" style="width: 1.5151515151515%"></div>
<pre>

Record Monomorphism {C} x y :=
  {
    Monomorphism_morphism :&gt; morphism C x y;
    Monomorphism_IsMonomorphism :&gt; IsMonomorphism Monomorphism_morphism
  }.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 250
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Global Existing Instances Epimorphism_IsEpimorphism Monomorphism_IsMonomorphism.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 252
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Local Notation "x -&gt;&gt; y" := (Epimorphism x y).</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 254
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
Local Notation "x (-&gt; y" := (Monomorphism x y).</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 255
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Class IsSectionOf C x y (s : morphism C x y) (r : morphism C y x)
  := is_sect_morphism : r o s = identity _.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 258
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Arguments IsSectionOf [C x y] s r.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 260
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Section EpiMono.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 262
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Variable C : PreCategory.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 263
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Section properties.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 265
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    (** *** The identity is an epimorphism *)
   </pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 267
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance isepimorphism_identity (x : C)
    : IsEpimorphism (identity x).</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 268
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 269
Time: 0.008s">
<div class="time" style="width: 12.121212121212%"></div>
<pre>
      repeat intro; autorewrite with morphism in *; trivial.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 270
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Qed.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 271
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** *** The identity is a monomorphism *)
   </pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 274
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance ismonomorphism_identity (x : C)
    : IsMonomorphism (identity x).</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 275
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 276
Time: 0.012s">
<div class="time" style="width: 18.181818181818%"></div>
<pre>
      repeat intro; autorewrite with morphism in *; trivial.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 277
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Qed.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 278
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** *** Composition of epimorphisms gives an epimorphism *)
   </pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 281
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance isepimorphism_compose s d d' m0 m1
    : IsEpimorphism m0
      -&gt; IsEpimorphism m1
      -&gt; IsEpimorphism (@compose C s d d' m0 m1).</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 284
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 285
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      repeat intro.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 286
Time: 0.009s">
<div class="time" style="width: 13.636363636364%"></div>
<pre>
      rewrite &lt;- !associativity in *.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 287
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply_hyp.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 288
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Qed.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 289
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** *** Composition of monomorphisms gives a monomorphism *)
   </pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 292
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance ismonomorphism_compose s d d' m0 m1
    : IsMonomorphism m0
      -&gt; IsMonomorphism m1
      -&gt; IsMonomorphism (@compose C s d d' m0 m1).</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 295
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 296
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      repeat intro.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 297
Time: 0.011s">
<div class="time" style="width: 16.666666666667%"></div>
<pre>
      rewrite !associativity in *.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 298
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      apply_hyp.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 299
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Qed.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 300
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  End properties.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 301
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** *** Existence of {epi,mono}morphisms are a preorder *)
 </pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 304
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section equiv.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 304
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Global Instance reflexive_epimorphism : Reflexive (@Epimorphism C)
      := fun x =&gt; Build_Epimorphism (isepimorphism_identity x).</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 306
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    Global Instance reflexive_monomorphism : Reflexive (@Monomorphism C)
      := fun x =&gt; Build_Monomorphism (ismonomorphism_identity x).</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 309
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    Global Instance transitive_epimorphism : Transitive (@Epimorphism C)
      := fun _ _ _ m0 m1 =&gt; Build_Epimorphism (isepimorphism_compose m1 m0).</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 312
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    Global Instance transitive_monomorphism : Transitive (@Monomorphism C)
      := fun _ _ _ m0 m1 =&gt; Build_Monomorphism (ismonomorphism_compose m1 m0).</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 315
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  End equiv.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 316
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Section sect.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 318
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Local Ltac epi_mono_sect_t :=
      let t :=
          (solve [ autorewrite with morphism;
                   reflexivity
                 | rewrite_hyp;
                   autorewrite with morphism;
                   reflexivity ]) in
      first [ rewrite -&gt; ?associativity; t
            | rewrite &lt;- ?associativity; t].</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 327
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** *** Retractions are epimorphisms *)
   </pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 330
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance isepimorphism_retr `(@IsSectionOf C x y s r)
    : IsEpimorphism r | 1000.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 331
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 332
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      (intros ? m1 m2 ?).</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 333
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      unfold IsSectionOf in *.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 334
Time: 0.038s">
<div class="time" style="width: 57.575757575758%"></div>
<pre>
      transitivity ((m1 o r) o s);
        [ | transitivity ((m2 o r) o s) ];
        epi_mono_sect_t.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 337
Time: 0.001s">
<div class="time" style="width: 1.5151515151515%"></div>
<pre>
    Qed.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 338
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** *** Sections are monomorphisms *)
   </pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 341
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance ismonomorphism_sect `(@IsSectionOf C x y s r)
    : IsMonomorphism s | 1000.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 342
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    Proof.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 343
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
      (intros ? m1 m2 ?).</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 344
Time: 0.044s">
<div class="time" style="width: 66.666666666667%"></div>
<pre>
      transitivity (r o (s o m1));
        [ | transitivity (r o (s o m2)) ];
        epi_mono_sect_t.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 347
Time: 0.001s">
<div class="time" style="width: 1.5151515151515%"></div>
<pre>
    Qed.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 348
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    (** *** Isomorphisms are both sections and retractions *)
   </pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 351
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance issect_isisomorphism `(@IsIsomorphism C x y m)
    : IsSectionOf m m^-1 | 1000
      := left_inverse.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 353
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

    Global Instance isretr_isisomorphism `(@IsIsomorphism C x y m)
    : IsSectionOf m^-1 m | 1000
      := right_inverse.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 357
Time: 0.001s">
<div class="time" style="width: 1.5151515151515%"></div>
<pre>
  End sect.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 358
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** *** Isomorphisms are therefore epimorphisms and monomorphisms *)
 </pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 361
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section iso.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 361
Time: 0.001s">
<div class="time" style="width: 1.5151515151515%"></div>
<pre>
    Global Instance isepimorphism_isisomorphism `(@IsIsomorphism C s d m)
    : IsEpimorphism m | 1000
      := _.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 364
Time: 0.001s">
<div class="time" style="width: 1.5151515151515%"></div>
<pre>
    Global Instance ismonomorphism_isisomorphism `(@IsIsomorphism C s d m)
    : IsMonomorphism m | 1000
      := _.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 367
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  End iso.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 368
Time: 0.002s">
<div class="time" style="width: 3.030303030303%"></div>
<pre>
End EpiMono.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 369
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Hint Immediate
  isepimorphism_identity ismonomorphism_identity
  ismonomorphism_compose isepimorphism_compose
  : category morphism.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 374
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Lemmas about [idtoiso] *)</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 376
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section iso_lemmas.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 376
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Local Ltac idtoiso_t :=
    path_induction; simpl; autorewrite with morphism; reflexivity.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 378
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** *** [transport]ing across an equality of morphisms is the same as conjugating with [idtoiso] *)
 </pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 381
Time: 0.002s">
<div class="time" style="width: 3.030303030303%"></div>
<pre>Lemma idtoiso_of_transport (C D : PreCategory) s d
        (m1 m2 : morphism C s d)
        (p : m1 = m2)
        (s' d' : morphism C s d -&gt; D) u
  : @transport _ (fun m =&gt; morphism D (s' m) (d' m)) _ _ p u
    = idtoiso _ (ap d' p) o u o (idtoiso _ (ap s' p))^-1.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 386
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 387
Time: 0.006s">
<div class="time" style="width: 9.0909090909091%"></div>
<pre> idtoiso_t.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 387
Time: 0.001s">
<div class="time" style="width: 1.5151515151515%"></div>
<pre> Qed.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 387
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** *** [idtoiso] respects inverse *)
 </pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 390
Time: 0.001s">
<div class="time" style="width: 1.5151515151515%"></div>
<pre>Lemma idtoiso_inv (C : PreCategory) (s d : C) (p : s = d)
  : (idtoiso _ p)^-1 = idtoiso _ (p^)%path.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 391
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 392
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    path_induction; reflexivity.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 393
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 394
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** *** [idtoiso] respects composition *)
 </pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 397
Time: 0.001s">
<div class="time" style="width: 1.5151515151515%"></div>
<pre>Lemma idtoiso_comp (C : PreCategory) (s d d' : C)
        (m1 : d = d') (m2 : s = d)
  : idtoiso _ m1 o idtoiso _ m2 = idtoiso _ (m2 @ m1)%path.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 399
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 400
Time: 0.004s">
<div class="time" style="width: 6.0606060606061%"></div>
<pre> idtoiso_t.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 400
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> Qed.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 400
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** These are useful when tactics are too slow and [rewrite] doesn't
      work. *)
 </pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 404
Time: 0.001s">
<div class="time" style="width: 1.5151515151515%"></div>
<pre>Lemma idtoiso_comp3 (C : PreCategory) (s d d' d'' : C)
        (m0 : d' = d'') (m1 : d = d') (m2 : s = d)
  : idtoiso _ m0 o (idtoiso _ m1 o idtoiso _ m2) = idtoiso _ ((m2 @ m1) @ m0)%path.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 406
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 407
Time: 0.006s">
<div class="time" style="width: 9.0909090909091%"></div>
<pre> idtoiso_t.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 407
Time: 0.001s">
<div class="time" style="width: 1.5151515151515%"></div>
<pre> Qed.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 407
Time: 0.001s">
<div class="time" style="width: 1.5151515151515%"></div>
<pre>

  Lemma idtoiso_comp3' (C : PreCategory) (s d d' d'' : C)
        (m0 : d' = d'') (m1 : d = d') (m2 : s = d)
  : (idtoiso _ m0 o idtoiso _ m1) o idtoiso _ m2 = idtoiso _ (m2 @ (m1 @ m0))%path.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 411
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 412
Time: 0.006s">
<div class="time" style="width: 9.0909090909091%"></div>
<pre> idtoiso_t.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 412
Time: 0.001s">
<div class="time" style="width: 1.5151515151515%"></div>
<pre> Qed.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 412
Time: 0.002s">
<div class="time" style="width: 3.030303030303%"></div>
<pre>

  Lemma idtoiso_comp4 (C : PreCategory) (s d d' d'' d''' : C)
        (m0 : d'' = d''') (m1 : d' = d'') (m2 : d = d') (m3 : s = d)
  : idtoiso _ m0 o (idtoiso _ m1 o (idtoiso _ m2 o idtoiso _ m3)) = idtoiso _ (((m3 @ m2) @ m1) @ m0)%path.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 416
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 417
Time: 0.007s">
<div class="time" style="width: 10.606060606061%"></div>
<pre> idtoiso_t.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 417
Time: 0.001s">
<div class="time" style="width: 1.5151515151515%"></div>
<pre> Qed.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 417
Time: 0.002s">
<div class="time" style="width: 3.030303030303%"></div>
<pre>

  Lemma idtoiso_comp4' (C : PreCategory) (s d d' d'' d''' : C)
        (m0 : d'' = d''') (m1 : d' = d'') (m2 : d = d') (m3 : s = d)
  : ((idtoiso _ m0 o idtoiso _ m1) o idtoiso _ m2) o idtoiso _ m3 = idtoiso _ (m3 @ (m2 @ (m1 @ m0)))%path.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 421
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 422
Time: 0.012s">
<div class="time" style="width: 18.181818181818%"></div>
<pre> idtoiso_t.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 422
Time: 0.001s">
<div class="time" style="width: 1.5151515151515%"></div>
<pre> Qed.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 422
Time: 0.003s">
<div class="time" style="width: 4.5454545454545%"></div>
<pre>

  Lemma idtoiso_comp5 (C : PreCategory) (s d d' d'' d''' d'''' : C)
        (m0 : d''' = d'''') (m1 : d'' = d''') (m2 : d' = d'') (m3 : d = d') (m4 : s = d)
  : idtoiso _ m0 o (idtoiso _ m1 o (idtoiso _ m2 o (idtoiso _ m3 o idtoiso _ m4)))
    = idtoiso _ ((((m4 @ m3) @ m2) @ m1) @ m0)%path.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 427
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 428
Time: 0.011s">
<div class="time" style="width: 16.666666666667%"></div>
<pre> idtoiso_t.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 428
Time: 0.002s">
<div class="time" style="width: 3.030303030303%"></div>
<pre> Qed.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 428
Time: 0.003s">
<div class="time" style="width: 4.5454545454545%"></div>
<pre>

  Lemma idtoiso_comp5' (C : PreCategory) (s d d' d'' d''' d'''' : C)
        (m0 : d''' = d'''') (m1 : d'' = d''') (m2 : d' = d'') (m3 : d = d') (m4 : s = d)
  : (((idtoiso _ m0 o idtoiso _ m1) o idtoiso _ m2) o idtoiso _ m3) o idtoiso _ m4
    = idtoiso _ (m4 @ (m3 @ (m2 @ (m1 @ m0))))%path.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 433
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 434
Time: 0.009s">
<div class="time" style="width: 13.636363636364%"></div>
<pre> idtoiso_t.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 434
Time: 0.002s">
<div class="time" style="width: 3.030303030303%"></div>
<pre> Qed.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 434
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** *** [idtoiso] respects application of functors on morphisms and objects *)
 </pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 437
Time: 0.001s">
<div class="time" style="width: 1.5151515151515%"></div>
<pre>Lemma idtoiso_functor (C D : PreCategory) (s d : C) (m : s = d)
        (F : Functor C D)
  : F _1 (idtoiso _ m) = idtoiso _ (ap (object_of F) m).</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 439
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 440
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    path_induction; simpl; apply identity_of.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 441
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 442
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** *** Functors preserve isomorphisms *)
 </pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 445
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Global Instance iso_functor C D (F : Functor C D) `(@IsIsomorphism C s d m)
  : IsIsomorphism (F _1 m).</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 446
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 447
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    refine ({| morphism_inverse := F _1 m^-1 |}).</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 448
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 449
Time: 0.004s">
<div class="time" style="width: 6.0606060606061%"></div>
<pre> abstract (rewrite &lt;- composition_of, ?left_inverse, ?right_inverse, identity_of; reflexivity).</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 449
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
    -</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 450
Time: 0.004s">
<div class="time" style="width: 6.0606060606061%"></div>
<pre> abstract (rewrite &lt;- composition_of, ?left_inverse, ?right_inverse, identity_of; reflexivity).</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 450
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Defined.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 451
Time: 0.002s">
<div class="time" style="width: 3.030303030303%"></div>
<pre>
End iso_lemmas.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 452
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Hint Extern 1 (@IsIsomorphism _ _ _ (@morphism_of ?C ?D ?F ?s ?d ?m))
=&gt; apply (@iso_functor C D F s d m) : typeclass_instances.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 455
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Hint Rewrite idtoiso_of_transport idtoiso_inv idtoiso_comp idtoiso_functor.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 457
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Lemmas about how to move isomorphisms around equalities, following [HoTT.PathGroupoids] *)</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 459
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Section iso_concat_lemmas.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 459
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Variable C : PreCategory.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 460
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Local Ltac iso_concat_t' :=
    intros;
    repeat match goal with
             | [ H : ?x = ?y |- _ ] =&gt; atomic y; induction H
             | [ H : ?x = ?y |- _ ] =&gt; atomic x; symmetry in H; induction H
           end;
    repeat first [ done
                 | rewrite -&gt; ?associativity;
                   progress rewrite ?left_identity, ?right_identity, ?left_inverse, ?right_inverse
                 | rewrite &lt;- ?associativity;
                   progress rewrite ?left_identity, ?right_identity, ?left_inverse, ?right_inverse
                 | rewrite -&gt; ?associativity; progress f_ap; []
                 | rewrite &lt;- ?associativity; progress f_ap; [] ].</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 474
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Local Ltac iso_concat_t_id_fin :=
    match goal with
      | [ |- context[@identity ?C ?x] ]
        =&gt; generalize dependent (identity x)
    end;
    iso_concat_t'.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 481
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Local Ltac iso_concat_t_id lem :=
    first [ solve [
                etransitivity; [ | eapply lem ];
                iso_concat_t_id_fin
              ]
          | solve [
                etransitivity; [ symmetry; eapply lem | ];
                iso_concat_t_id_fin
          ] ].</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 491
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Local Ltac iso_concat_t :=
    iso_concat_t';
    try first [ solve [ iso_concat_t_id @left_identity ]
              | solve [ iso_concat_t_id @right_identity ] ].</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 496
Time: 0.001s">
<div class="time" style="width: 1.5151515151515%"></div>
<pre>

  Definition iso_compose_pV `(@IsIsomorphism C x y p)
  : p o p^-1 = identity _
    := right_inverse.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 500
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Definition iso_compose_Vp `(@IsIsomorphism C x y p)
  : p^-1 o p = identity _
    := left_inverse.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 503
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition iso_compose_V_pp `(@IsIsomorphism C y z p) `(q : morphism C x y)
  : p^-1 o (p o q) = q.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 506
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 507
Time: 0.011s">
<div class="time" style="width: 16.666666666667%"></div>
<pre> iso_concat_t.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 507
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> Qed.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 507
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition iso_compose_p_Vp `(@IsIsomorphism C x z p) `(q : morphism C y z)
  : p o (p^-1 o q) = q.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 510
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 511
Time: 0.011s">
<div class="time" style="width: 16.666666666667%"></div>
<pre> iso_concat_t.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 511
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> Qed.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 511
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition iso_compose_pp_V `(p : morphism C y z) `(@IsIsomorphism C x y q)
  : (p o q) o q^-1 = p.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 514
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 515
Time: 0.015s">
<div class="time" style="width: 22.727272727273%"></div>
<pre> iso_concat_t.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 515
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> Qed.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 515
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition iso_compose_pV_p `(p : morphism C x z) `(@IsIsomorphism C x y q)
  : (p o q^-1) o q = p.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 518
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 519
Time: 0.01s">
<div class="time" style="width: 15.151515151515%"></div>
<pre> iso_concat_t.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 519
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> Qed.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 519
Time: 0.003s">
<div class="time" style="width: 4.5454545454545%"></div>
<pre>

  Definition iso_inv_pp `(@IsIsomorphism C y z p) `(@IsIsomorphism C x y q)
  : (p o q)^-1 = q^-1 o p^-1.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 522
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 523
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> iso_concat_t.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 523
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> Qed.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 523
Time: 0.002s">
<div class="time" style="width: 3.030303030303%"></div>
<pre>

  Definition iso_inv_Vp `(@IsIsomorphism C y z p) `(@IsIsomorphism C x z q)
  : (p^-1 o q)^-1 = q^-1 o p.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 526
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 527
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> iso_concat_t.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 527
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> Qed.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 527
Time: 0.002s">
<div class="time" style="width: 3.030303030303%"></div>
<pre>

  Definition iso_inv_pV `(@IsIsomorphism C x y p) `(@IsIsomorphism C x z q)
  : (p o q^-1)^-1 = q o p^-1.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 530
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 531
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> iso_concat_t.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 531
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> Qed.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 531
Time: 0.003s">
<div class="time" style="width: 4.5454545454545%"></div>
<pre>

  Definition iso_inv_VV `(@IsIsomorphism C x y p) `(@IsIsomorphism C y z q)
  : (p^-1 o q^-1)^-1 = q o p.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 534
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 535
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> iso_concat_t.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 535
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> Qed.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 535
Time: 0.001s">
<div class="time" style="width: 1.5151515151515%"></div>
<pre>

  Definition iso_moveR_Mp `(p : morphism C x y) `(q : morphism C x z) `(@IsIsomorphism C y z r)
  : p = (r^-1 o q) -&gt; (r o p) = q.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 538
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 539
Time: 0.012s">
<div class="time" style="width: 18.181818181818%"></div>
<pre> iso_concat_t.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 539
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> Qed.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 539
Time: 0.001s">
<div class="time" style="width: 1.5151515151515%"></div>
<pre>

  Definition iso_moveR_pM `(@IsIsomorphism C x y p) `(q : morphism C x z) `(r : morphism C y z)
  : r = (q o p^-1) -&gt; (r o p) = q.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 542
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 543
Time: 0.01s">
<div class="time" style="width: 15.151515151515%"></div>
<pre> iso_concat_t.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 543
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> Qed.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 543
Time: 0.001s">
<div class="time" style="width: 1.5151515151515%"></div>
<pre>

  Definition iso_moveR_Vp `(p : morphism C x y) `(q : morphism C x z) `(@IsIsomorphism C z y r)
  : p = (r o q) -&gt; (r^-1 o p) = q.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 546
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 547
Time: 0.012s">
<div class="time" style="width: 18.181818181818%"></div>
<pre> iso_concat_t.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 547
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> Qed.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 547
Time: 0.001s">
<div class="time" style="width: 1.5151515151515%"></div>
<pre>

  Definition iso_moveR_pV `(@IsIsomorphism C x y p) `(q : morphism C y z) `(r : morphism C x z)
  : r = (q o p) -&gt; (r o p^-1) = q.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 550
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 551
Time: 0.01s">
<div class="time" style="width: 15.151515151515%"></div>
<pre> iso_concat_t.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 551
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> Qed.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 551
Time: 0.001s">
<div class="time" style="width: 1.5151515151515%"></div>
<pre>

  Definition iso_moveL_Mp `(p : morphism C x y) `(q : morphism C x z) `(@IsIsomorphism C y z r)
  : (r^-1 o q) = p -&gt; q = (r o p).</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 554
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 555
Time: 0.02s">
<div class="time" style="width: 30.30303030303%"></div>
<pre> iso_concat_t.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 555
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> Qed.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 555
Time: 0.001s">
<div class="time" style="width: 1.5151515151515%"></div>
<pre>

  Definition iso_moveL_pM `(@IsIsomorphism C x y p) `(q : morphism C x z) `(r : morphism C y z)
  : (q o p^-1) = r -&gt; q = (r o p).</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 558
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 559
Time: 0.009s">
<div class="time" style="width: 13.636363636364%"></div>
<pre> iso_concat_t.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 559
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> Qed.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 559
Time: 0.001s">
<div class="time" style="width: 1.5151515151515%"></div>
<pre>

  Definition iso_moveL_Vp `(p : morphism C x y) `(q : morphism C x z) `(@IsIsomorphism C _ _ r)
  : (r o q) = p -&gt; q = (r^-1 o p).</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 562
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 563
Time: 0.017s">
<div class="time" style="width: 25.757575757576%"></div>
<pre> iso_concat_t.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 563
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> Qed.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 563
Time: 0.001s">
<div class="time" style="width: 1.5151515151515%"></div>
<pre>

  Definition iso_moveL_pV `(@IsIsomorphism C x y p) `(q : morphism C y z) r
  : (q o p) = r -&gt; q = (r o p^-1).</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 566
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 567
Time: 0.011s">
<div class="time" style="width: 16.666666666667%"></div>
<pre> iso_concat_t.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 567
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> Qed.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 567
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition iso_moveL_1M `(p : morphism C x y) `(@IsIsomorphism C x y q)
  : p o q^-1 = identity _ -&gt; p = q.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 570
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 571
Time: 0.018s">
<div class="time" style="width: 27.272727272727%"></div>
<pre> iso_concat_t.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 571
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> Qed.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 571
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition iso_moveL_M1 `(p : morphism C x y) `(@IsIsomorphism C x y q)
  : q^-1 o p = identity _ -&gt; p = q.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 574
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 575
Time: 0.047s">
<div class="time" style="width: 71.212121212121%"></div>
<pre> iso_concat_t.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 575
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> Qed.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 575
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition iso_moveL_1V `(p : morphism C x y) `(@IsIsomorphism C y x q)
  : p o q = identity _ -&gt; p = q^-1.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 578
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 579
Time: 0.017s">
<div class="time" style="width: 25.757575757576%"></div>
<pre> iso_concat_t.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 579
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> Qed.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 579
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition iso_moveL_V1 `(p : morphism C x y) `(@IsIsomorphism C y x q)
  : q o p = identity _ -&gt; p = q^-1.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 582
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 583
Time: 0.038s">
<div class="time" style="width: 57.575757575758%"></div>
<pre> iso_concat_t.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 583
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> Qed.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 583
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition iso_moveR_M1 `(@IsIsomorphism C x y p) q
  : identity _ = p^-1 o q -&gt; p = q.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 586
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 587
Time: 0.057s">
<div class="time" style="width: 86.363636363636%"></div>
<pre> iso_concat_t.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 587
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> Qed.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 587
Time: 0.001s">
<div class="time" style="width: 1.5151515151515%"></div>
<pre>

  Definition iso_moveR_1M `(@IsIsomorphism C x y p) q
  : identity _ = q o p^-1 -&gt; p = q.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 590
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 591
Time: 0.031s">
<div class="time" style="width: 46.969696969697%"></div>
<pre> iso_concat_t.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 591
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> Qed.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 591
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Definition iso_moveR_1V `(@IsIsomorphism C x y p) q
  : identity _ = q o p -&gt; p^-1 = q.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 594
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 595
Time: 0.031s">
<div class="time" style="width: 46.969696969697%"></div>
<pre> iso_concat_t.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 595
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> Qed.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 595
Time: 0.001s">
<div class="time" style="width: 1.5151515151515%"></div>
<pre>

  Definition iso_moveR_V1 `(@IsIsomorphism C x y p) q
  : identity _ = p o q -&gt; p^-1 = q.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 598
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 599
Time: 0.053s">
<div class="time" style="width: 80.30303030303%"></div>
<pre> iso_concat_t.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 599
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre> Qed.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 599
Time: 0.002s">
<div class="time" style="width: 3.030303030303%"></div>
<pre>
End iso_concat_lemmas.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 600
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Tactics for moving inverses around *)</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 602
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Ltac iso_move_inverse' :=
  match goal with
    | [ |- _^-1 o _ = _ ] =&gt; apply iso_moveR_Vp
    | [ |- _ = _^-1 o _ ] =&gt; apply iso_moveL_Vp
    | [ |- _ o _^-1 = _ ] =&gt; apply iso_moveR_pV
    | [ |- _ = _ o _^-1 ] =&gt; apply iso_moveL_pV
    | [ |- _ o (_ o _^-1) = _ ] =&gt; rewrite &lt;- associativity
    | [ |- _ = _ o (_ o _^-1) ] =&gt; rewrite &lt;- associativity
    | [ |- (_^-1 o _) o _ = _ ] =&gt; rewrite -&gt; associativity
    | [ |- _ = (_^-1 o _) o _ ] =&gt; rewrite -&gt; associativity
  end.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 612
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Ltac iso_move_inverse := progress repeat iso_move_inverse'.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 614
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

(** ** Tactics for collapsing [p ∘ p⁻¹] and [p⁻¹ ∘ p] *)
(** Now the tactics for collapsing [p ∘ p⁻¹] (and [p⁻¹ ∘ p]) in the
    middle of a chain of compositions of isomorphisms. *)

</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 619
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>Ltac iso_collapse_inverse_left' :=
  first [ apply ap
        | progress rewrite ?iso_compose_p_Vp, ?iso_compose_V_pp ].</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 621
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Ltac iso_collapse_inverse_left :=
  rewrite -&gt; ?Category.Core.associativity;
  progress repeat iso_collapse_inverse_left'.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 625
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Ltac iso_collapse_inverse_right' :=
  first [ apply ap10; apply ap
        | progress rewrite ?iso_compose_pV_p, ?iso_compose_pp_V ].</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 629
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Ltac iso_collapse_inverse_right :=
  rewrite &lt;- ?Category.Core.associativity;
  progress repeat iso_collapse_inverse_right'.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 633
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Ltac iso_collapse_inverse :=
  progress repeat first [ iso_collapse_inverse_left
                        | iso_collapse_inverse_right ].</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 637
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Section associativity_composition.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 639
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Variable C : PreCategory.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 640
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Variables x0 x1 x2 x3 x4 : C.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 641
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  (** This lemma is helpful for backwards reasoning. *)
 </pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 644
Time: 0.001s">
<div class="time" style="width: 1.5151515151515%"></div>
<pre>Lemma compose4associativity_helper
    (a : morphism C x3 x4) (b : morphism C x2 x3)
    (c : morphism C x1 x2) (d : morphism C x0 x1)
  : a o b o c o d = (a o ((b o c) o d)).</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 647
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Proof.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 648
Time: 0.003s">
<div class="time" style="width: 4.5454545454545%"></div>
<pre>
    rewrite !associativity; reflexivity.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 649
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Qed.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 650
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
End associativity_composition.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 651
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

Module Export CategoryMorphismsNotations.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 653
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Notation "m ^-1" := (morphism_inverse m) : morphism_scope.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 654
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Infix "&lt;~=~&gt;" := Isomorphic : category_scope.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 656
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

  Notation "x -&gt;&gt; y" := (Epimorphism x y).</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 658
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
  Notation "x (-&gt; y" := (Monomorphism x y).</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 659
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>
End CategoryMorphismsNotations.</pre>
</div>
<div class="code" title="File: Morphisms.v
Line: 661
Time: 0s">
<div class="time" style="width: 0%"></div>
<pre>

</pre>
</div>
</body>
</html>

